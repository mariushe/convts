{"version":3,"sources":["components/network/DisplayNetwork.tsx","convts/activations/activations.ts","convts/math/math.ts","convts/layer/ActivationLayer.ts","convts/weight/weight.ts","convts/layer/ConnectedLayer.ts","convts/loss/loss.ts","convts/log/Logger.ts","convts/network/Network.ts","convts/recorder/NeuronListener.ts","components/network/Neuron.tsx","App.tsx","convts/network/networks.ts","reportWebVitals.ts","index.tsx"],"names":["DisplayLayer","layer","className","name","getInputSize","getOutputSize","Layers","network","layers","map","l","i","DisplayNetwork","LeakyRelu","input","i1","i2","LeakyReluPrime","dot","a","b","length","b1","b2","Array","from","keys","_","j","reduce","acc","v2","a1","filter","n","isNaN","q","multiply","Error","subtract","transpose","array","columnIndex","row","ActivationLayer","index","activation","activationPrime","neuronListener","output","this","recordNeurons","outputError","learningRate","createRandomWeights","dim0","dim1","Math","random","ConnectedLayer","inputSize","outputSize","weight","bias","t","add","inputError","weightError","Mse","loss","expected","predicted","count","x1","x2","pow","v","acc2","lossPrime","divide","logger","require","Network","data","forwardPropagate","trainingData","categories","epochs","lastEpochError","epoch","error","x","debug","backPropagate","info","backPropagation","forwardPropagation","NeuronListener","callback","record","lastUpdate","Date","now","result","Neuron","probability","toFixed","NeuralRenderer","Object","values","style","display","nn","App","useState","setLastUpdate","ii","console","log","create","createSimpleNetwork","undefined","setLastEpochError","onClick","fit","startRecording","predict","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.435eadb3.chunk.js","sourcesContent":["import React from \"react\";\nimport Network from \"../../convts/network/Network\";\nimport Layer from \"../../convts/layer/Layer\";\n\nconst DisplayLayer = ({ layer }: { layer: Layer }) => {\n  return (\n    <div>\n      <div\n        className={\n          \"px-4 p-2 m-4 max-w-sm mx-auto bg-gray-800 rounded-xl shadow-md flex items-center space-x-4\"\n        }\n      >\n        {layer.name()}{\" \"}\n        {layer.getInputSize() && layer.getOutputSize()\n          ? ` (${layer.getInputSize()}, ${layer.getOutputSize()})`\n          : \"\"}\n      </div>\n    </div>\n  );\n};\n\nconst Layers = ({ network }: { network: Network }) => {\n  return (\n    <section>\n      <h1 className={\"text-3xl\"}>Layers</h1>\n      {network.layers.map((l, i) => (\n        <DisplayLayer key={`layer_${i}`} layer={l} />\n      ))}\n    </section>\n  );\n};\n\nconst DisplayNetwork = ({ network }: { network: Network }) => {\n  return (\n    <div>\n      <Layers network={network} />\n    </div>\n  );\n};\n\nexport default DisplayNetwork;\n","\nexport type Activation = (input: number[][]) => number[][];\n\nexport const Relu: Activation = (input: number[][]) => {\n    return input.map((i1) => i1.map((i2) => {\n        return i2 > 0 ? i2 : 0;\n    }))\n}\n\nexport const ReluPrime: Activation = (input: number[][]) => {\n    return input.map((i1) => i1.map((i2) => {\n        return i2 > 0 ? 1 : 0;\n    }))\n}\n\nexport const LeakyRelu: Activation = (input: number[][]) => {\n    return input.map((i1) => i1.map((i2) => {\n        return i2 > 0 ? i2 : i2 * 0.01;\n    }))\n}\n\nexport const LeakyReluPrime: Activation = (input: number[][]) => {\n    return input.map((i1) => i1.map((i2) => {\n        return i2 > 0 ? 1 : 0.01;\n    }))\n}","// https://towardsdatascience.com/linear-algebra-basics-dot-product-and-matrix-multiplication-2a7624942810\nexport const dot = (a: number[][], b: number[][]): number[][] => {\n\n  // Edge cases that should be moved into algorithm \n  if (a.length === 1 && a[0].length === 1 && b.length === 1) {\n    return b.map((b1) => b1.map((b2) => b2 * a[0][0]))\n  }\n\n  if (a.length === 1 && a[0].length > 1 && b.length === a[0].length) {\n    return [Array.from(Array(b[0].length).keys()).map((_, i) => {\n      return a[0].map((_, j) => a[0][j] * b[j][i]).reduce((acc,v2) => acc + v2, 0);\n    })];\n  }\n\n  \n  if (a[0].length === 1 && b.length === 1) {\n    return a.map((a1, i1) => {\n      return b[0].map((_, i2) => {\n        return a[i1][0] * b[0][i2];\n      }).filter((n) => !isNaN(n));\n    });  \n  }\n\n  return a.map((a1, i1) => {\n    return a.map((_, i2) => {\n      return Array.from(Array(a1.length).keys()).reduce((acc, q) => {\n        //console.log(`a[${i1}][${q}] * b[${q}][${i2}]`)\n        return acc + a[i1][q] * b[q][i2];\n      }, 0);\n\n      //return a[i1][i2] * b[i2][i1];\n    }).filter((n) => !isNaN(n));\n  });\n};\nexport const multiply = (a: number[][], b: number | number[][]): number[][] => {\n  if (typeof b === \"number\") {\n    return a.map((_, i) => a[i].map((_, j) => a[i][j] * b));\n  }\n  if (a.length === b.length) {\n    return a.map((_, i) =>\n      a[0].map((_, j) => {\n        return a[i][j] * b[i][j];\n      })\n      );\n    } else if (a.length === 1) {\n      return b.map((_, i) =>\n      b[0].map((_, j) => {\n        return a[0][j] * b[i][j];\n      })\n      );\n    } else if (b.length === 1) {\n      return a.map((_, i) =>\n      a[0].map((_, j) => {\n        return a[i][j] * b[0][j];\n      })\n    );\n  }\n\n  throw Error(`Dimentions didn't match. a=${a} b=${b}`);\n};\n\nexport const divide = (a: number[][], b: number | number[][]): number[][] => {\n  if (typeof b === \"number\") {\n    return a.map((_, i) => a[i].map((_, j) => a[i][j] / b));\n  }\n  if (a.length === b.length) {\n    return a.map((_, i) =>\n      a[0].map((_, j) => {\n        return a[i][j] / b[i][j];\n      })\n    );\n  } else if (a.length === 1) {\n    return b.map((_, i) =>\n      b[0].map((_, j) => {\n        return a[0][j] / b[i][j];\n      })\n    );\n  } else if (b.length === 1) {\n    return a.map((_, i) =>\n      a[0].map((_, j) => {\n        return a[i][j] / b[0][j];\n      })\n    );\n  }\n\n  throw Error(`Dimentions didn't match. a=${a} b=${b}`);\n};\n\nexport const add = (a: number[][], b: number[][]): number[][] => {\n  if (a.length === b.length) {\n    return a.map((_, i) =>\n      a[0].map((_, j) => {\n        return a[i][j] + b[i][j];\n      })\n    );\n  } else if (a.length === 1) {\n    return b.map((_, i) =>\n      b[0].map((_, j) => {\n        return a[0][j] + b[i][j];\n      })\n    );\n  } else if (b.length === 1) {\n    return a.map((_, i) =>\n      a[0].map((_, j) => {\n        return a[i][j] + b[0][j];\n      })\n    );\n  }\n\n  throw Error(`Dimentions didn't match. a=${a} b=${b}`);\n};\n\nexport const subtract = (a: number[][], b: number[][]): number[][] => {\n  if (a.length === b.length) {\n    return a.map((_, i) =>\n      a[0].map((_, j) => {\n        return a[i][j] - b[i][j];\n      })\n    );\n  } else if (a.length === 1) {\n    return b.map((_, i) =>\n      b[0].map((_, j) => {\n        return a[0][j] - b[i][j];\n      })\n    );\n  } else if (b.length === 1) {\n    return a.map((_, i) =>\n      a[0].map((_, j) => {\n        return a[i][j] - b[0][j];\n      })\n    );\n  }\n\n  throw Error(`Dimentions didn't match. a=${a} b=${b}`);\n};\n\n/**\n * Transpose two dim array. \n * This flips the matrix over its diagonal.\n * It does this by switching the row and column indices.\n * https://en.wikipedia.org/wiki/Transpose\n * https://numpy.org/doc/stable/reference/generated/numpy.transpose.html#numpy.transpose \n */\nexport const transpose = (array: number[][]): number[][] => {\n  return array[0].map((_, columnIndex) => array.map((row) => row[columnIndex]));\n};\n","import { Activation } from \"../activations/activations\";\nimport { multiply } from \"../math/math\";\nimport { NeuronListener } from \"../recorder/NeuronListener\";\nimport Layer from \"./Layer\";\n\nclass ActivationLayer implements Layer {\n  activation;\n  activationPrime;\n  input: number[][] = [];\n  output : number[][] = [];\n  index: number;\n  neuronListener: NeuronListener;\n  constructor(index: number, activation: Activation, activationPrime: Activation, neuronListener: NeuronListener) {\n    this.activation = activation;\n    this.activationPrime = activationPrime;\n    this.index = index;\n    this.neuronListener = neuronListener;\n  }\n\n  name(): string {\n    return \"Activation\"\n  }\n\n  getInputSize(): number | undefined {\n    return undefined;\n  }\n\n  getOutputSize(): number | undefined {\n    return undefined;\n  }\n\n  forwardPropagation(input: number[][]): number[][] {\n    this.input = input;\n    this.output = this.activation(input);\n    if (this.neuronListener) {\n      this.neuronListener.recordNeurons(this.index, this.output)\n    }\n    return this.output;\n  }\n  backPropagation(outputError: number[][], learningRate: number): number[][] {\n      //console.log(\"Activation layer: outputError[\",outputError,\"], input[\",this.input,\"], activationPrime[\" +this.activationPrime(this.input) + \"], multiplied[\" + multiply(this.activationPrime(this.input), outputError) + \"]\" )\n    return multiply(this.activationPrime(this.input), outputError);\n  }\n}\n\nexport default ActivationLayer;\n","/**\n * Creates a 2 dim matrix of random weights to be\n * used as initial weights for layers.\n * @param d0 length of dim0\n * @param d1 length of dim1\n */\nexport const createRandomWeights = (dim0: number, dim1: number): number[][] => {\n  return Array.from(Array(dim0).keys()).map((_) => {\n    return Array.from(Array(dim1).keys()).map((_) => {\n      return Math.random() - 0.5;\n    });\n  });\n};\n","import { logger } from \"../log/Logger\";\nimport { add, dot, multiply, subtract, transpose } from \"../math/math\";\nimport { NeuronListener } from \"../recorder/NeuronListener\";\nimport { createRandomWeights } from \"../weight/weight\";\nimport Layer from \"./Layer\";\n\nclass ConnectedLayer implements Layer {\n  weight: number[][];\n  bias: number[][];\n  input: number[][] = [];\n  inputSize: number;\n  outputSize: number;\n  index: number;\n  neuronListener?: NeuronListener\n  constructor(index: number, inputSize: number, outputSize: number, neuronListener?: NeuronListener) {\n    this.index = index;\n    this.inputSize = inputSize;\n    this.outputSize = outputSize;\n    this.weight = createRandomWeights(inputSize, outputSize);\n    this.bias = createRandomWeights(1, outputSize);\n    this.neuronListener = neuronListener\n  }\n\n  getInputSize(): number {\n    return this.inputSize;\n  }\n\n  getOutputSize(): number {\n    return this.outputSize;\n  }\n\n  name(): string {\n    return \"Connected\";\n  }\n\n  forwardPropagation(input: number[][]): number[][] {\n    this.input = input;\n    const t = add(dot(input, this.weight), this.bias);\n    if (this.neuronListener) {\n      this.neuronListener.recordNeurons(this.index, t)\n    }\n    return t;\n  }\n  backPropagation(outputError: number[][], learningRate: number): number[][] {\n    const inputError = dot(outputError, transpose(this.weight));\n    const weightError = dot(transpose(this.input), outputError);\n    //console.log(\"CONNECTED LAYER - weights[\", this.weight,\"], \",\"outputError[\", outputError,\"], inputError[\",inputError,\"], weightError[\",weightError,\"]\");\n    this.weight = subtract(this.weight, multiply(weightError, learningRate));\n    this.bias = subtract(this.bias, multiply(outputError, learningRate));\n\n    return inputError;\n  }\n}\n\nexport default ConnectedLayer;\n","import { divide, multiply, subtract } from \"../math/math\";\n\nexport type LossFunction = (expected: number[][], predicted: number[][]) => number;\nexport type LossPrime = (expected: number[][], predicted: number[][]) => number[][];\n\nexport interface Loss {\n    loss: LossFunction;\n    lossPrime: LossPrime;\n}\n\nexport const meanSquaredError: LossFunction = (\n  expected: number[][],\n  predicted: number[][]\n) => {\n  let count = 0;\n  const value = subtract(expected, predicted)\n    .map((x1) => {\n      return x1.map((x2) => {\n        count += 1;\n        return Math.pow(x2, 2);\n      });\n    })\n    .reduce((acc, v) => {\n      return (\n        acc +\n        v.reduce((acc2, v2) => {\n          return acc2 + v2;\n        }, 0)\n      );\n    }, 0);\n  return value / count;\n};\n\nconst countElements = (n: number[][]) => {\n  return n.reduce((acc, v) => acc + v.length, 0);\n};\n\nexport const meanSquaredErrorPrime: LossPrime = (\n  expected: number[][],\n  predicted: number[][]\n) => {\n  let count = countElements(expected);\n  return multiply(divide(subtract(predicted, expected), count), 2);\n};\n\nexport const Mse: Loss = {\n    loss: meanSquaredError,\n    lossPrime: meanSquaredErrorPrime,\n}\n","export const logger = require('pino')()","import React from \"react\";\nimport Layer from \"../layer/Layer\";\nimport { logger } from \"../log/Logger\";\nimport { Loss } from \"../loss/loss\";\nimport { NeuronListener } from \"../recorder/NeuronListener\";\n\nclass Network {\n  layers: Layer[];\n  loss: Loss;\n  learningRate: number = 0.1;\n  private constructor(layers: Layer[], loss: Loss) {\n    this.layers = layers;\n    this.loss = loss;\n  }\n\n  public static create(layers: Layer[], loss: Loss): Network {\n    return new Network(layers, loss);\n  }\n\n  public predict(data: number[][]) {\n    return this.forwardPropagate(data);\n  }\n\n  public fit(\n    trainingData: number[][][],\n    categories: number[][][],\n    epochs: number\n  ) {\n    let lastEpochError = -1;\n    for (let epoch = 1; epoch <= epochs; epoch++) {\n      const err = trainingData\n        .map((x, i) => {\n          const output = this.forwardPropagate(x);\n          logger.debug({\"Expected\": categories[i], \"Predicted\": output})\n          this.backPropagate(categories[i], output);\n          return this.loss.loss(categories[i], output);\n        })\n        .reduce((acc, v) => acc + v, 0);\n\n      \n      const error = err / trainingData.length;\n      logger.info(\n        `Epoch ${epoch}/${epochs} error=${error}`\n      );\n      lastEpochError=error;\n    }\n    return lastEpochError\n  }\n\n  private backPropagate(expected: number[][], predicted: number[][]) {\n    let error = this.loss.lossPrime(expected, predicted);\n    logger.debug({\"LOSS PRIME \": error})\n    for (var i = this.layers.length - 1; i >= 0; i--) {\n      error = this.layers[i].backPropagation(error, this.learningRate);\n    }\n  }\n\n  private forwardPropagate(data: number[][]) {\n    return this.layers.reduce((output, layer) => {\n      return layer.forwardPropagation(output);\n    }, data);\n  }\n\n  \n}\n\nexport default Network;\n","\n\nexport class NeuronListener {\n\n    callback: (index: number, input: any) => void\n    record: boolean = false\n    lastUpdate: number = Date.now();\n    result: {[_: string]: number[][]} = {}\n\n    constructor(callback: (index: number, input: any) => void) {\n      this.callback = callback\n    }\n\n    startRecording() {\n        this.record = true\n    }\n\n    stopRecording() {\n        this.record = false\n    }\n\n    recordNeurons(index: number, input: any) {\n        if (this.record) {\n            this.lastUpdate = Date.now();\n            this.callback(index, input)\n            this.result[`${index}`] = input\n        }\n    }\n  }","import React from \"react\";\n\nconst Neuron = ({ probability }: { probability: number }) => {\n  return (\n    <div\n      className={`flex justify-center items-center m-1 w-12 h-12 ${\n        probability > 0.1 ? \"bg-red-500\" : \"bg-gray-500\"\n      } bg-opacity-50 rounded-full border-red-700`}\n    >\n      {probability.toFixed(2)}\n    </div>\n  );\n};\n\nexport default Neuron;\n","import React, { useEffect, useState } from \"react\";\nimport logo from \"./logo.svg\";\nimport \"./App.css\";\nimport DisplayNetwork from \"./components/network/DisplayNetwork\";\nimport { createSimpleNetwork } from \"./convts/network/networks\";\nimport Network from \"./convts/network/Network\";\nimport { NeuronListener } from \"./convts/recorder/NeuronListener\";\nimport Neuron from \"./components/network/Neuron\";\n\n\n\nconst NeuralRenderer = ({\n  lastUpdate,\n  neuronListener,\n}: {\n  lastUpdate: number;\n  neuronListener: NeuronListener;\n}) => {\n  return (\n    <div>\n      Last update{lastUpdate}\n      {Object.values(neuronListener.result).map((n) => (\n        <div style={{ display: \"flex\" }}>\n          {n[0].map((nn) => (\n            <Neuron probability={nn} />\n          ))}\n        </div>\n      ))}\n    </div>\n  );\n};\n\nfunction App() {\n  const [lastUpdate, setLastUpdate] = useState(Date.now());\n  const [neuronListener, setNeuronListener] = useState<NeuronListener>(\n    new NeuronListener((i, ii) => console.log(ii))\n  );\n  const [network, setNetwork] = useState<Network>(\n    createSimpleNetwork(neuronListener)\n  );\n  const [lastEpochError, setLastEpochError] = useState<number | undefined>(\n    undefined\n  );\n  const trainingData = [[[0, 0]], [[0, 1]], [[1, 0]], [[1, 1]]];\n  const categories = [[[0]], [[1]], [[1]], [[0]]];\n\n  return (\n    <div className=\"min-h-screen bg-gray-900 text-white\">\n      <main>\n        <DisplayNetwork network={network} />\n        <button\n          onClick={() => {\n            setLastEpochError(network.fit(trainingData, categories, 1000));\n            neuronListener.startRecording();\n          }}\n          className=\"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full\"\n        >\n          Create and train\n        </button>\n        {lastEpochError && <p>Error after last epoch: {lastEpochError}</p>}\n        {lastEpochError && (\n          <p\n            onClick={() => {\n              network.predict([[1, 0]]);\n              setLastUpdate(neuronListener.lastUpdate);\n            }}\n          >\n            Testing 1,0\n          </p>\n        )}\n        {lastEpochError && (\n          <p\n            onClick={() => {\n              network.predict([[0, 0]]);\n              setLastUpdate(neuronListener.lastUpdate);\n            }}\n          >\n            Testing 0,0\n          </p>\n        )}\n        {lastEpochError && (\n          <p\n            onClick={() => {\n              network.predict([[0, 1]]);\n              setLastUpdate(neuronListener.lastUpdate);\n            }}\n          >\n            Testing 0,1\n          </p>\n        )}\n        {lastEpochError && (\n          <p\n            onClick={() => {\n              network.predict([[1, 1]]);\n              setLastUpdate(neuronListener.lastUpdate);\n            }}\n          >\n            Testing 1,1\n          </p>\n        )}\n        <NeuralRenderer\n          lastUpdate={lastUpdate}\n          neuronListener={neuronListener}\n        />\n        {/* {lastEpochError && <p>Testing 0,1: {network.predict([[0,1]])}</p>}\n        {lastEpochError && <p>Testing 1,1: {network.predict([[1,1]])}</p>}\n        {lastEpochError && <p>Testing 0,1: {network.predict([[1,0]])}</p>} */}\n      </main>\n    </div>\n  );\n}\n\nexport default App;\n","import { LeakyRelu, LeakyReluPrime } from \"../activations/activations\";\nimport ActivationLayer from \"../layer/ActivationLayer\";\nimport ConnectedLayer from \"../layer/ConnectedLayer\";\nimport { Mse } from \"../loss/loss\";\nimport { NeuronListener } from \"../recorder/NeuronListener\";\nimport Network from \"./Network\";\n\n\nexport const createSimpleNetwork = (neuronListener: NeuronListener) => {\n    return Network.create(\n        [\n            new ConnectedLayer(1, 2,3, neuronListener),\n            new ActivationLayer(2, LeakyRelu,LeakyReluPrime, neuronListener),\n            new ConnectedLayer(3, 3,1, neuronListener),\n            new ActivationLayer(4, LeakyRelu,LeakyReluPrime, neuronListener)\n        ], \n        Mse\n    );\n}","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}